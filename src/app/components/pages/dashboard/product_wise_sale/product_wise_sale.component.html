<div class="topics-list">
  <div class="topic-container new-ticket">
    <div class="box-widget widget-module" style="margin-bottom: 0;">
      <div class="widget-head clearfix">
        <span class="h-icon"><i class="fa fa-table"></i></span>
        <h4>
          Product Wise Sale
        </h4>
        <div class="col-xs-12 col-md-3 form-group-sm">
          <div style="margin: 12px;">
            <month-picker [month]="_month" [year]="_year"
                          [title]="''"
                          (onMonthYearChanged)="monthYearChanged($event)"></month-picker>
          </div>
        </div>
      </div>
      <div class="widget-container details-table" #loading_box>
        <div class="widget-block">
          <div class="table-responsive">
            <table class="table table-bordered">
              <thead>
              <tr>
                <th>Product</th>
                <th>Target (<i class="fa fa-rupee"></i>)</th>
                <th>Actual Sale(<i class="fa fa-rupee"></i> )</th>
                <th *ngIf="environment.projectName != '3c'">Actual Pending Sale(<i class="fa fa-rupee"></i> )</th>
                <th>Last year same month actual sale(<i class="fa fa-rupee"></i> )</th>
                <th>POB (<i class="fa fa-rupee"></i> )</th>
                <th>% Performance</th>
                <th>Target(YTD) (<i class="fa fa-rupee"></i>)</th>
                <th>Actual Sale(YTD)(<i class="fa fa-rupee"></i> )</th>
                <th>% Performance (YTD)</th>
              </tr>
              </thead>
              <tbody>
              <template ngFor let-item [ngForOf]="products">
                <tr *ngIf="environment.projectName != 'IKON'">
                  <td>
                    {{ item.brands.name }}
                  </td>
                  <td class="text-right">{{ item.target.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id != 7" class="text-right">{{ item.performance.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id == 7"  class="text-right">{{ item.performance_total.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf=" _service.user.role_id != 7 && environment.projectName != '3c'" class="text-right">{{ item.performance_pending.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf=" _service.user.role_id == 7 && environment.projectName != '3c'" class="text-right">{{ item.performance_pending_total.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ item.last_year_month_performance.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ item.total_pob.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id != 7" class="text-right">{{ (item.target > 0 ? (item.performance / item.target) * 100 : 0).toFixed(2)
                    }}
                  </td>
                  <td *ngIf="_service.user.role_id == 7" class="text-right">{{ (item.target > 0 ? (item.performance_total / item.target) * 100 : 0).toFixed(2)
                    }}
                  </td>
                  <td class="text-right">{{ item.total_target.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ item.total_primary_sale.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ (item.total_target > 0 ? (item.total_primary_sale / item.total_target) * 100
                    : 0).toFixed(2)
                    }}
                  </td>
                </tr>
              </template>
              <template ngFor let-item [ngForOf]="products">
                <tr *ngIf="item.brands.id <=4 && environment.projectName == 'IKON'">
                  <td>
                    {{ item.brands.icon_name }}
                  </td>
                  <td class="text-right">{{ item.target.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id != 7" class="text-right">{{ item.performance.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id == 7"  class="text-right">{{ item.performance_total.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id != 7" class="text-right">{{ item.performance_pending.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id == 7" class="text-right">{{ item.performance_pending_total.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ item.last_year_month_performance.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ item.total_pob.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id != 7" class="text-right">{{ (item.target > 0 ? (item.performance / item.target) * 100 : 0).toFixed(2)
                    }}
                  </td>
                  <td *ngIf="_service.user.role_id == 7" class="text-right">{{ (item.target > 0 ? (item.performance_total / item.target) * 100 : 0).toFixed(2)
                    }}
                  </td>
                  <td class="text-right">{{ item.total_target.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ item.total_primary_sale.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ (item.total_target > 0 ? (item.total_primary_sale / item.total_target) * 100
                    : 0).toFixed(2)
                    }}
                  </td>
                </tr>
              </template>
              <tr STYLE="background-color: #ffa31a" *ngIf="environment.projectName == 'IKON'  && _department_id != 2">
                <th>ICON Total</th>
                <th class="text-right">{{ (total_icon_target ).toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id != 7" class="text-right">{{ total_icon_actual.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id == 7" class="text-right">{{ total_product_icon_actual.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id != 7" class="text-right">{{ total_pending_icon_actual.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id == 7"class="text-right">{{ total_pending_product_icon_actual.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_last_month_icon_actual.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_icon_pob.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id != 7" class="text-right">{{ (total_icon_target > 0 ? (total_icon_actual / total_icon_target) * 100 : 0).toFixed(2) }}</th>
                <th *ngIf="_service.user.role_id == 7" class="text-right">{{ (total_icon_target > 0 ? (total_product_icon_actual /  total_icon_target) * 100 : 0).toFixed(2) }}</th>
                <th class="text-right">{{  till_month_icon_total_target.toFixed(0) | number }}</th>
                <th class="text-right">{{  till_month_total_sale_icon?.toFixed(0) | number }}</th>
                <th class="text-right">{{ (till_month_icon_total_target > 0 ? (till_month_total_sale_icon /
                   till_month_icon_total_target) * 100 : 0).toFixed(2) }}
                </th>
              </tr>
              <template ngFor let-item [ngForOf]="products">
                <tr *ngIf="item.brands.id > 4  && environment.projectName == 'IKON' ">
                  <td>
                    {{ item.brands.chl_name }}
                  </td>
                  <td class="text-right">{{ item.target.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id != 7" class="text-right">{{ item.performance.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id == 7"  class="text-right">{{ item.performance_total.toFixed(0) | number : fractionSize }}</td>
                  <td  *ngIf="_service.user.role_id != 7" class="text-right">{{ item.performance_pending.toFixed(0) | number : fractionSize }}</td>
                  <td  *ngIf="_service.user.role_id == 7" class="text-right">{{ item.performance_pending_total.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ item.last_year_month_performance.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ item.total_pob.toFixed(0) | number : fractionSize }}</td>
                  <td *ngIf="_service.user.role_id != 7" class="text-right">{{ (item.target > 0 ? (item.performance / item.target) * 100 : 0).toFixed(2)
                    }}
                  </td>
                  <td *ngIf="_service.user.role_id == 7" class="text-right">{{ (item.target > 0 ? (item.performance_total / item.target) * 100 : 0).toFixed(2)
                    }}
                  </td>
                  <td class="text-right">{{ item.total_target.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ item.total_primary_sale.toFixed(0) | number : fractionSize }}</td>
                  <td class="text-right">{{ (item.total_target > 0 ? (item.total_primary_sale / item.total_target) * 100
                    : 0).toFixed(2)
                    }}
                  </td>
                </tr>
              </template>
              <tr style="background-color: #80deea" *ngIf="environment.projectName == 'IKON' && _department_id != 1">
                <th>CHL Total</th>
                <th class="text-right">{{ total_geo_target.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_geo_actual.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_pending_geo_actual.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_last_month_geo_actual.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_geo_pob.toFixed(0) | number }}</th>
                <th class="text-right">{{ (total_geo_target > 0 ? (total_geo_actual / total_geo_target) * 100 :
                  0).toFixed(2) }}
                </th>
                <th class="text-right">{{ till_month_geo_total_target.toFixed(0) | number }}</th>
                <th class="text-right">{{ till_month_total_sale_geo?.toFixed(0) | number }}</th>
                <th class="text-right">{{ (till_month_geo_total_target > 0 ? (till_month_total_sale_geo /
                  till_month_geo_total_target) * 100 : 0).toFixed(2) }}
                </th>
              </tr>
              <tr style="background-color: #00c853" *ngIf="environment.projectName == 'IKON'  && _service.user.role_id != 6">
                <th>Total</th>
                <th class="text-right">{{ total_target.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id != 7" class="text-right">{{ total_actual.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id == 7" class="text-right">{{ total_actual_sales.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id != 7" class="text-right">{{ total_pending_actual.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id == 7" class="text-right">{{ total_pending_actual_sales.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_last_year_month_actual.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_pob.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id != 7" class="text-right">{{ (total_target > 0 ? (total_actual / total_target) * 100 : 0).toFixed(2) }}</th>
                <th *ngIf="_service.user.role_id == 7" class="text-right">{{ (total_target > 0 ? (total_actual_sales / total_target) * 100 : 0).toFixed(2) }}</th>
                <th class="text-right">{{ till_month_total_target.toFixed(0) | number }}</th>
                <th class="text-right">{{ till_month_total_sale?.toFixed(0) | number }}</th>
                <th class="text-right">{{ (till_month_total_target > 0 ? (till_month_total_sale /
                  till_month_total_target) * 100 : 0).toFixed(2) }}
                </th>
              </tr>
              <tr style="background-color: #00c853"  *ngIf="environment.projectName != 'IKON'">
                <th>Total</th>
                <th class="text-right">{{ total_target.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id != 7" class="text-right">{{ total_actual.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id == 7" class="text-right">{{ total_actual_sales.toFixed(0) | number }}</th>
                <th *ngIf="environment.projectName != '3c' && _service.user.role_id != 7" class="text-right">{{ total_pending_actual.toFixed(0) | number }}</th>
                <th *ngIf="environment.projectName != '3c' && _service.user.role_id == 7" class="text-right">{{ total_pending_actual_sales.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_last_year_month_actual.toFixed(0) | number }}</th>
                <th class="text-right">{{ total_pob.toFixed(0) | number }}</th>
                <th *ngIf="_service.user.role_id != 7" class="text-right">{{ (total_target > 0 ? (total_actual / total_target) * 100 : 0).toFixed(2) }}</th>
                <th *ngIf="_service.user.role_id == 7" class="text-right">{{ (total_target > 0 ? (total_actual_sales / total_target) * 100 : 0).toFixed(2) }}</th>
                <th class="text-right">{{ till_month_total_target.toFixed(0) | number }}</th>
                <th class="text-right">{{ till_month_total_sale?.toFixed(0) | number }}</th>
                <th class="text-right">{{ (till_month_total_target > 0 ? (till_month_total_sale /
                  till_month_total_target) * 100 : 0).toFixed(2) }}
                </th>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
